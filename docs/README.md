# ObsidianObserver Plugin

A comprehensive Obsidian plugin that tracks file events (open, save, close) and stores them as individual notes with rich metadata for enhanced DataView compatibility and analysis.

## Features

### Event Tracking
- **File Open Events**: Logs when files are opened in Obsidian
- **File Save Events**: Logs when files are modified and saved
- **File Close Events**: Logs when files are closed
- **Rich Metadata**: Includes file paths, timestamps, vault information, and modification times

### Unique GUIDs
- **Base32 GUIDs**: Each event gets a unique Base32-encoded identifier
- **Collision-Free**: Ensures no duplicate event IDs
- **Queryable**: GUIDs can be used in DataView queries for precise event tracking

### Individual Note Storage
- **One Note Per Event**: Each event is stored as a separate markdown file
- **Frontmatter Data**: All event data is stored in YAML frontmatter with `OOEvent_` prefixes
- **Minimal Content**: Each event note contains only frontmatter and a link to the original file
- **Organized Structure**: Events are stored in `_debug/events/` directory
- **DataView Compatible**: Frontmatter fields are optimized for DataView queries
- **Version Tracking**: Plugin version included in each event's frontmatter for debugging
- **Enhanced Table Styling**: CSS automatically deployed to expand DataView tables to double width
- **Organized CSS Structure**: CSS files stored in `obsidian/snippets/` directory

### Professional Styling
- **CSS Integration**: Automatic styling for DataView tables
- **Color Coding**: Light blue headers, green data cells for easy identification
- **Responsive Design**: Adapts to different screen sizes
- **Dark Mode Support**: Compatible with Obsidian's dark theme

## Installation

1. Download the latest release from the releases page
2. Extract the plugin files to your Obsidian vault's `.obsidian/plugins/` directory
3. Enable the plugin in Obsidian settings
4. The plugin will automatically create the events directory and start tracking

## Configuration

The plugin creates an events directory at `_debug/events/` where all event notes are stored. Each event note contains:

### Frontmatter Fields
- `OOEvent_GUID`: Unique Base32 identifier
- `OOEvent_Timestamp`: ISO timestamp of the event
- `OOEvent_Type`: Event type (open/save/close)
- `OOEvent_FilePath`: Full path to the file
- `OOEvent_FileName`: Name of the file
- `OOEvent_VaultName`: Name of the vault
- `OOEvent_LastModified`: Last modification time of the file
- `OOEvent_Created`: When the event note was created
- `OOEvent_PluginVersion`: Version of the plugin that created the event

## DataView Queries

### Basic Event Queries
```dataview
TABLE OOEvent_GUID, OOEvent_Type, OOEvent_FileName, OOEvent_VaultName, OOEvent_Timestamp
FROM "_debug/events"
WHERE OOEvent_Type = "open"
SORT OOEvent_Timestamp DESC
LIMIT 10
```

### Event Statistics
```dataview
TABLE length(rows) as "Count"
FROM "_debug/events"
GROUP BY OOEvent_Type
```

### Recent Activity
```dataview
TABLE OOEvent_FileName, OOEvent_Type, OOEvent_Timestamp
FROM "_debug/events"
SORT OOEvent_Timestamp DESC
LIMIT 20
```

### File-Specific Events
```dataview
TABLE OOEvent_GUID, OOEvent_Type, OOEvent_Timestamp
FROM "_debug/events"
WHERE OOEvent_FileName = "MyNote.md"
SORT OOEvent_Timestamp DESC
```

### Project Activity
```dataview
TABLE OOEvent_FileName, OOEvent_Type, OOEvent_Timestamp
FROM "_debug/events"
WHERE contains(OOEvent_FilePath, "Projects")
SORT OOEvent_Timestamp DESC
```

## File Structure

```
_debug/
‚îî‚îÄ‚îÄ events/
    ‚îú‚îÄ‚îÄ _summary.md                    # Summary and query examples
    ‚îú‚îÄ‚îÄ ABC123DEF456GHI789JKL012.md    # Individual event notes
    ‚îú‚îÄ‚îÄ XYZ789ABC123DEF456GHI789.md    # Each with unique GUID
    ‚îî‚îÄ‚îÄ ...

obsidian/
‚îî‚îÄ‚îÄ snippets/
    ‚îî‚îÄ‚îÄ obsidianObserverEventsTable.css  # CSS styling for event summary tables
```

## Event Note Format

Each event note contains:

```markdown
---
aliases: [OPEN Event, MyNote.md]
tags: [obsidian-explorer, event, open]
type: obsidian-event
OOEvent_GUID: ABC123DEF456GHI789JKL012
OOEvent_Timestamp: 2025-08-26T02:30:00.000Z
OOEvent_Type: open
OOEvent_FilePath: MyNote.md
OOEvent_FileName: MyNote.md
OOEvent_VaultName: MyVault
OOEvent_LastModified: 2025-08-26T02:25:00.000Z
OOEvent_Created: 2025-08-26T02:30:00.000Z
OOEvent_PluginVersion: 00.00.01_0009
---

# OPEN Event - MyNote.md

**GUID:** ABC123DEF456GHI789JKL012
**Type:** OPEN
**File:** MyNote.md
**Path:** MyNote.md
**Vault:** MyVault
**Time:** 2025-08-26T02:30:00.000Z
**Last Modified:** 2025-08-26T02:25:00.000Z

## Event Details

This event was automatically generated by the ObsidianObserver plugin.

- **Event Type:** open
- **File Name:** MyNote.md
- **File Path:** MyNote.md
- **Vault:** MyVault
- **Timestamp:** 2025-08-26T02:30:00.000Z
- **Last Modified:** 2025-08-26T02:25:00.000Z

## DataView Queries

You can query this event using DataView:

```dataview
TABLE OOEvent_GUID, OOEvent_Type, OOEvent_FileName, OOEvent_VaultName, OOEvent_Timestamp
FROM "_debug/events"
WHERE OOEvent_Type = "open"
SORT OOEvent_Timestamp DESC
```

```dataview
TABLE OOEvent_GUID, OOEvent_Type, OOEvent_FileName, OOEvent_VaultName, OOEvent_Timestamp
FROM "_debug/events"
WHERE OOEvent_GUID = "ABC123DEF456GHI789JKL012"
```
```

## Manual Controls

The plugin provides several ribbon icons for manual control:

- **üêõ Test Logging**: Creates a test event note
- **üîÑ Flush Buffer**: Manually flushes the event buffer
- **üìÑ Create Summary**: Creates or updates the events summary file

## Troubleshooting

### Events Not Being Created
1. Check that the plugin is enabled in Obsidian settings
2. Verify the `_debug/events/` directory exists
3. Check the browser console for error messages

### DataView Queries Not Working
1. Ensure the DataView plugin is installed and enabled
2. Verify the frontmatter fields are correctly formatted
3. Check that the query path matches your events directory

### Performance Issues
1. The plugin uses buffering to reduce file I/O
2. Events are written in batches of 3 by default
3. Manual flush is available via the ribbon icon

## Development

### Building the Plugin
```powershell
# Auto-detect version from directory name (recommended)
./bin/build.ps1

# Build with custom options (auto-detects version)
./bin/build.ps1 -SkipDependencies -CreatePackage  # Skip dependencies, create package
./bin/build.ps1 -VaultName "TestVault"  # Update specific vault

# Build with manual version specification
./bin/build.ps1 -BuildVersion "00.01.10"
```

### Testing
- Use the test logging ribbon icon to create test events
- Check the `_debug/events/` directory for generated notes
- Verify DataView queries work with the new format

## Version History

### v00.01.25
- **Command Palette Integration**: Moved sync functionality from ribbon icon to command palette for better discoverability
- **Build Number System**: Automatic build number incrementing with version format `v00.00.00_9999`

### v00.01.21
- **Simplified Event Notes**: Each event note now contains only frontmatter and a link to the original file
- **Reduced File Size**: Significantly smaller event notes for better performance

### v00.01.10
- **Individual Note Storage**: Each event is now stored as a separate markdown file
- **Frontmatter Integration**: All event data stored in YAML frontmatter with `OOEvent_` prefixes
- **Enhanced DataView Support**: Optimized for DataView queries and analysis
- **Summary File**: Automatic creation of events summary with query examples

### v00.01.09
- **GUID Implementation**: Added Base32 GUIDs for unique event identification
- **CSS Styling**: Professional DataView table styling with color coding
- **Build System**: Enhanced build process with version parameterization

### v00.01.08
- **DataView Compatibility**: Improved log format for better DataView integration
- **Bug Fixes**: Resolved log file access issues and formatting problems
